

[build]
  command = "npm run build && echo 'BUILD_SHA=$(git rev-parse HEAD)' > dist/version.txt"

[[headers]]
  for = "/my-poetry-app*.js"
  [headers.values]
    # Sicurezza
    Content-Security-Policy = "default-src 'self' https:; script-src 'self' 'unsafe-inline' https://widget.theitalianpoetryproject.com"
    Referrer-Policy = "strict-origin-when-cross-origin"
    
    # Performance
    Cache-Control = "public, max-age=600, stale-while-revalidate=300"
    Netlify-CDN-Cache-Control = "public, max-age=3600, stale-while-revalidate=600"
    
    # Debug
    Server-Timing = "cdn;desc=\"Netlify CDN\""
    X-Widget-Build = "$(date +%Y%m%d)"
    X-SourceMap = "/my-poetry-app.iife.js.map"

[[headers]]
  for = "/version.txt"
  [headers.values]
    Cache-Control = "no-store"
    
[dev]
  autoLaunch = true
